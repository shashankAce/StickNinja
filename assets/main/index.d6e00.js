window.__require=function t(i,e,s){function n(o,r){if(!e[o]){if(!i[o]){var a=o.split("/");if(a=a[a.length-1],!i[a]){var h="function"==typeof __require&&__require;if(!r&&h)return h(a,!0);if(c)return c(a,!0);throw new Error("Cannot find module '"+o+"'")}o=a}var u=e[o]={exports:{}};i[o][0].call(u.exports,function(t){return n(i[o][1][t]||t)},u,u.exports,t,i,e,s)}return e[o].exports}for(var c="function"==typeof __require&&__require,o=0;o<s.length;o++)n(s[o]);return n}({gameOver:[function(t,i,e){"use strict";cc._RF.push(i,"3d6b6qt+6pF+rPoIhMAfUwP","gameOver"),cc.Class({extends:cc.Component,properties:{score:cc.Node,playAgain:cc.Node,backHome:cc.Node},onLoad:function(){},updateScore:function(){var t=cc.sys.localStorage.getItem("NinjaScore"),i=cc.sys.localStorage.getItem("NinjaBestScore");this.score.getComponent(cc.Label).string="Score\n"+t+"\nBest\n"+i;var e=this.node.parent.getChildByName("MainCamera");cc.tween(e).by(.1,{y:-10}).by(.1,{y:10}).by(.1,{y:-10}).by(.1,{y:10}).start()},onPlayAgain:function(){this.node.parent.getComponent("main").restartGame()},onBackHome:function(){}}),cc._RF.pop()},{}],heroManager:[function(t,i,e){"use strict";cc._RF.push(i,"87c30gElEhJyIvcTzkdXcfT","heroManager"),cc.Class({extends:cc.Component,properties:{animation:cc.Animation},onLoad:function(){}}),cc._RF.pop()},{}],hudManager:[function(t,i,e){"use strict";cc._RF.push(i,"fedc3a8oY1P9IwzIbDFiDfH","hudManager"),cc.Class({extends:cc.Component,properties:{life1:cc.Node,life2:cc.Node,life3:cc.Node,bestScore:cc.Label},onLoad:function(){this.reset()},reset:function(){this.lifeCount=3,this.updateLifeUI();var t=cc.sys.localStorage.getItem("NinjaBestScore");this.bestScore.string=t||0},getLifeCount:function(){return this.lifeCount},setHighScore:function(){var t=parseInt(cc.sys.localStorage.getItem("NinjaScore"));cc.sys.localStorage.getItem("NinjaBestScore")?parseInt(cc.sys.localStorage.getItem("NinjaBestScore"))<t&&cc.sys.localStorage.setItem("NinjaBestScore",t):cc.sys.localStorage.setItem("NinjaBestScore",t);this.bestScore.string=cc.sys.localStorage.getItem("NinjaBestScore")},addLife:function(){this.lifeCount<3&&++this.lifeCount,this.updateLifeUI()},removeLife:function(){--this.lifeCount,this.updateLifeUI()},updateLifeUI:function(){0===this.lifeCount?(this.life1.active=!1,this.life2.active=!1,this.life3.active=!1):1==this.lifeCount?(this.life1.active=!0,this.life2.active=!1,this.life3.active=!1):2==this.lifeCount?(this.life1.active=!0,this.life2.active=!0,this.life3.active=!1):3==this.lifeCount&&(this.life1.active=!0,this.life2.active=!0,this.life3.active=!0)}}),cc._RF.pop()},{}],main:[function(t,i,e){"use strict";cc._RF.push(i,"9a44dGKGjlIbb6WNrPe6Ujx","main"),cc.Class({extends:cc.Component,properties:{gameLabel:cc.Node,begin:cc.Node,pipe1:cc.Node,pipe2:cc.Node,stick:cc.Node,stick2:cc.Node,hero:cc.Node,bg:cc.Node,hud:cc.Node,scoreBox:cc.Node,scoreText:cc.Node,bonus:cc.Node,bg1:cc.SpriteFrame,bg2:cc.SpriteFrame,bg3:cc.SpriteFrame,bg4:cc.SpriteFrame,bg5:cc.SpriteFrame,bg6:cc.SpriteFrame,gameOverNode:cc.Node,treasure:cc.Prefab,treasureBonus:cc.Prefab},ctor:function(){this.pipeHeight=184,this.heroPosY=-174,this.scrollTime=.5,this.stickTweenTime=2,this.heroSpeed=300,this.level=1,this.heroScrollPos=40,this.stickLengthThreshold=10,this.bonusAmount=5,this.goldValue=7,this.diamondValue=10,this.treasurePosition=cc.v2(0,-80),this.pipeArray=[],this.treasureArray=[],this.treasureScrollDist=160,this.pipeBonusY=-175,this.treBonusTextArray=[]},reset:function(){this.touchEnabled=!1,this.touchHold=!1,this.touchStartPoint=cc.v2(0,0),this.touchLastPoint=cc.v2(0,0),this.touchThreshold=50,this.stickAdded=!1,this.beginPressed=!1,this.gameStarted=!1,this.tweenCount=0,this.stickTween=null,this.stick.scale=1,this.stick.width=0,this.stick.active=!1,this.stick2.scale=1,this.stick2.width=0,this.stick2.active=!1,this.gameOverNode.active=!1,this.sneekTween=null,this.heroRunning=!1,this.heroJumping=!1,this.heroRunTween=null},resetScore:function(){if(this.score=0,this.scoreBox.active=!1,this.scoreText.active=!1,this.scoreText.getComponent(cc.Label).string="0",this.treasureArray.length)for(var t=0;t<this.treasureArray.length;t++){this.treasureArray[t].destroy()}this.treasureArray=[]},onLoad:function(){this.reset(),this.resetScore(),this.resetGravity(),this.hudManager=this.hud.getComponent("hudManager"),this.audio=this.node.getComponent("music"),this.audio.playBgMusic(),this.initMap(),this.bonus.active=!1;var t=cc.v2(-this.gameLabel.width/2,300);this.gameLabel.position=t;var i=cc.v2(0,this.begin.position.y),e=this.begin.getComponent(cc.Graphics);e.fillColor=(new cc.Color).fromHEX("#f08080"),e.circle(0,0,50),e.fill();var s="sineOut",n=cc.tween().to(1.5,{position:cc.v2(i.x,i.y-10)},{easing:s}).to(1.5,{position:cc.v2(i.x,i.y+10)},{easing:s});this.beginTween=cc.tween(this.begin).then(n).repeatForever().start(),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this,!0),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnded,this,!0),this.hero.position=cc.v2(0,this.heroPosY),this.hero.scale=.4,this.pipeArray.push(this.pipe1),this.pipeArray.push(this.pipe2),this.initPipes()},initMap:function(){var t=Math.floor(6*Math.random()+1);this.bg.getComponent(cc.Sprite).spriteFrame=this["bg"+t],this.bg.x=-cc.winSize.width/2-20},initPipes:function(){for(var t=0;t<this.pipeArray.length;t++){var i=this.pipeArray[t];if(t<1){var e=i.getComponent(cc.Graphics);e.clear(),e.rect(0,0,65,this.pipeHeight),e.fill(),i.graphicWidth=65,i.position=cc.v2(-32.5,-cc.winSize.height/2),i.getChildByName("redMark").active=!1}else{var s=this.getRandPipeWidth(),n=i.getComponent(cc.Graphics);n.clear(),n.rect(0,0,s,this.pipeHeight),n.fill(),i.graphicWidth=s,i.position=cc.v2(cc.winSize.width/2+10,-cc.winSize.height/2),i.getChildByName("redMark").setPosition(cc.v2(s/2,this.pipeHeight))}}},onBeginClick:function(){var t=this;if(!this.beginPressed){this.beginPressed=!0,this.audio.playGong();var i=cc.tween().to(.9,{angle:-60},{easing:"elasticOut"});cc.tween(this.gameLabel).then(i).call(function(){t.removeIntro()}).start()}},removeIntro:function(){var t=this,i=cc.tween().to(.7,{y:-400},{easing:"quartIn"});cc.tween(this.gameLabel).then(i).start(),this.beginTween.stop();var e=cc.tween().to(.7,{position:cc.v2(this.begin.position.x,1e3)},{easing:"quartIn"});cc.tween(this.begin).then(e).call(function(){t.initGame()}).start()},initGame:function(){var t,i=this;this.hero.x=0,this.hero.scale=.4;for(var e=0;e<this.pipeArray.length;e++){var s=this.pipeArray[e];if(0==e){t=s.position;var n=cc.tween().to(this.scrollTime,{x:-cc.winSize.width/2},{easing:"sineOut"});cc.tween(s).then(n).start()}else{var c=cc.tween().to(this.scrollTime,{x:this.getRandomPipeLocation()},{easing:"sineOut"});cc.tween(s).then(c).start()}}var o=t.x- -cc.winSize.width/2,r=this.hero.position.x-o,a=cc.tween().to(this.scrollTime,{x:r,y:this.heroPosY},{easing:"sineOut"});cc.tween(this.hero).then(a).call(function(){i.startGame()}).start()},startGame:function(){this.gameStarted=!0,this.touchEnabled=!0,this.scoreBox.active=!0,this.scoreText.active=!0},restartGame:function(){this.reset(),this.resetScore(),this.initPipes(),this.initGame(),this.initMap(),this.audio.playClick(),this.audio.playBgMusic(),this.hudManager.reset()},spawnAgain:function(){this.reset(),this.initPipes(),this.initGame()},addStick:function(){this.stick.active=!0,this.stick.angle=90,this.stick.width=0;var t=this.pipeArray[0];this.stick.position=cc.v2(t.position.x+t.graphicWidth,-184),this.stickTween=cc.tween(this.stick).to(this.stickTweenTime,{width:cc.winSize.width}).start(),this.stickAdded=!0;var i=this.hero.getChildByName("hero");this.sneekTween=cc.tween(i).then(cc.tween().by(.1,{y:-10}).by(.1,{y:10})).repeatForever().start()},dropStick:function(){var t=this;if(this.stickAdded){this.touchEnabled=!1,this.sneekTween.stop(),this.hero.getChildByName("hero").y=0;this.stickAdded=!1,this.stickTween.stop(),this.stick.width>this.stickLengthThreshold?cc.tween(this.stick).to(.7,{angle:0},{easing:"quadIn"}).call(function(){var i=t.pipeArray[1],e=i.position.x+i.graphicWidth/2-5,s=t.stick.position.x+t.stick.width;s>=e&&s<=e+10&&t.addBonus(),t.screenShake(),t.audio.playStickLanded(),t.heroRun()}).start():(this.stick.width=0,this.stick.active=!1,this.touchEnabled=!0)}},heroRun:function(){var t=this;this.heroRunning=!0;var i=this.stick.position.x+this.stick.width,e=(i-this.hero.x)/this.heroSpeed;this.heroRunTween=cc.tween(this.hero).to(e,{x:i}).call(function(){t.heroRunning=!1,t.checkFall()}).start()},checkFall:function(){var t=this,i=this.pipeArray[1];this.hero.position.x>i.position.x+i.graphicWidth||this.hero.position.x<i.position.x?cc.tween(this.hero).to(.5,{y:-cc.winSize.height/2-50}).call(function(){t.gameOver()}).start():(this.increaseScore(),this.scrollWorld(),this.stick.width=0)},gameOver:function(){this.hudManager.removeLife(),this.hudManager.getLifeCount()>0?(this.touchEnabled=!1,this.spawnAgain()):(cc.sys.localStorage.setItem("NinjaScore",this.score),this.hudManager.setHighScore(),this.touchEnabled=!1,this.gameStarted=!1,this.scoreBox.active=!1,this.scoreText.active=!1,this.gameOverNode.active=!0,this.gameOverNode.getComponent("gameOver").updateScore(),this.audio.stopBgMusic(),this.audio.playGameOver())},scrollWorld:function(){var t=this;this.tweenCount=0;var i=this.pipeArray[0],e=this.getRandomPipeLocation(),s=cc.tween().to(this.scrollTime/2,{x:-cc.winSize.width/2-i.graphicWidth}).call(function(){i.x=cc.winSize.width/2+10,t.changePipeSize(i),t.spawnEnemy(e)}).to(this.scrollTime/2,{x:e},{easing:"sineOut"}),n=this.pipeArray[1],c=-cc.winSize.width/2+this.heroScrollPos,o=this.hero.position.x-c,r=n.position.x-o,a=cc.tween().to(this.scrollTime,{x:r},{easing:"sineOut"}),h=cc.tween().to(this.scrollTime,{x:c},{easing:"sineOut"});cc.tween(i).then(s).call(function(){t.transposePipes()}).start(),cc.tween(n).then(a).call(function(){t.transposePipes()}).start(),cc.tween(this.hero).then(h).call(function(){t.transposePipes()}).start();var u=o/10;cc.tween(this.bg).by(this.scrollTime,{x:-u}).start(),this.spawnCoins(e)},transposePipes:function(){if(++this.tweenCount,3===this.tweenCount){var t=this.pipeArray[0];this.pipeArray[0]=this.pipeArray[1],this.pipeArray[1]=t,this.touchEnabled=!0}},changePipeSize:function(t){var i=t.getComponent(cc.Graphics),e=this.getRandPipeWidth();i.clear(),i.rect(0,0,e,this.pipeHeight),i.fill(),t.graphicWidth=e;var s=t.getChildByName("redMark");s.active=!0,s.setPosition(cc.v2(e/2,this.pipeHeight))},spawnCoins:function(){var t=this,i=this.getRandomBetween(3,0),e=this.getRandomBetween(3,1),s=0;if(this.treasureArray.length&&(s=this.treasureArray[this.treasureArray.length-1].x),i>0&&this.treasureArray.length<4&&s<cc.winSize.width/4)for(var n=1;n<=e;n++){var c=cc.instantiate(this.treasure);this.node.addChild(c);var o=c.getComponent("treasure");o.treasureValue=this.getTreasureValue("gold"),o.startTween(500*n),c.scale=.15,c.setPosition(cc.v2(cc.winSize.width/2+32*n,this.treasurePosition.y)),this.treasureArray.push(c)}for(var r=0;r<this.treasureArray.length;r++){var a=this.treasureArray[r];cc.tween(a).by(this.scrollTime,{x:-this.treasureScrollDist},{easing:"sineOut"}).call(function(){t.removeTreasure()}).start()}},removeTreasure:function(){for(var t=0;t<this.treasureArray.length;t++){var i=this.treasureArray[t];(i.x<-cc.winSize.width/2||i.isHit)&&(this.treasureArray.splice(t,1),i.destroy(),--t)}},getTreasureValue:function(t){var i=0;switch(t){case"gold":i=this.goldValue;break;case"diamond":i=this.diamondValue}return i},spawnEnemy:function(){},heroJump:function(){this.heroRunning=!1,this.heroJumping=!0,this.heroRunTween.stop(),this.audio.playJump(),this.vy=-this.mvy},heroLanded:function(){this.heroJumping=!1,this.stick.position.x+this.stick.width-this.hero.x>0&&(this.heroRunning=!1,this.heroRunTween.stop(),this.heroRun())},startHeroAnimation:function(){},increaseScore:function(){++this.score,this.scoreText.getComponent(cc.Label).string=this.score},addBonus:function(){var t=this,i=this.pipeArray[1],e=i.position.x+i.graphicWidth/2+5;this.bonus.opacity=255,this.bonus.setPosition(cc.v2(e,this.pipeBonusY)),this.bonus.getComponent(cc.Label).string=this.bonusAmount+"+",this.bonus.active=!0,this.score+=this.bonusAmount,this.scoreText.getComponent(cc.Label).string=this.score,cc.tween(this.bonus).by(.5,{y:20}).call(function(){t.bonus.active=!1}).start(),cc.tween(this.bonus).to(.5,{opacity:0}).start(),this.audio.playBonus()},addTreasureBonus:function(t){var i=cc.instantiate(this.treasureBonus);this.node.addChild(i),this.treBonusTextArray.push(i);var e=t.getComponent("treasure").treasureValue;i.setPosition(cc.v2(t.position.x,t.position.y+20)),i.getComponent(cc.Label).string=e+"+",cc.tween(i).by(.5,{y:30}).call(function(t){t.destroy()}).start(),cc.tween(i).to(.5,{opacity:0}).start(),this.audio.playCoin(),this.score+=e,this.scoreText.getComponent(cc.Label).string=this.score},screenShake:function(){var t=this.node.getChildByName("MainCamera");cc.tween(t).by(.1,{y:2}).by(.1,{y:-2}).start()},getRandomPipeLocation:function(){return Math.floor(131*Math.random()-50)},getRandomBetween:function(t,i){return Math.floor(Math.random()*(t-i+1)+i)},getRandPipeWidth:function(){var t=65,i=30;return(this.level=1)&&(i=(t=65)-20),Math.floor(Math.random()*(t-i+1)+i)},onTouchBegan:function(t,i){var e=t.getLocation();this.gameStarted&&this.touchEnabled?(this.touchHold=!0,this.addStick(),this.touchStartPoint=cc.v2(e.x,e.y),this.touchLastPoint=cc.v2(e.x,e.y)):this.gameStarted&&this.heroRunning&&this.heroJump()},onTouchMoved:function(t,i){if(this.gameStarted&&this.touchEnabled){var e=t.getLocation(),s=this.touchStartPoint;e.y>s.y+this.touchThreshold&&(e.y<this.touchLastPoint.y?(this.touchStartPoint=cc.v2(e.x,e.y),this.isSwipeUp=!1):this.isSwipeUp=!0),this.touchLastPoint=cc.v2(e.x,e.y)}},onTouchEnded:function(t,i){this.gameStarted&&this.touchEnabled&&(this.touchHold=!1,this.dropStick())},resetGravity:function(){this.cy=0,this.dt=.4,this.vy=0,this.mvy=20,this.gravity=.98,this.collision=!1},findCollision:function(){for(var t=!1,i=0;i<this.treasureArray.length;i++){var e=this.treasureArray[i].getBoundingBox();this.hero.getBoundingBox().intersects(e)&&(this.treasureArray[i].isHit=!0,this.addTreasureBonus(this.treasureArray[i]),t=!0)}t&&(this.removeTreasure(),t=!1)},update:function(){this.gameStarted&&(this.cy-=this.vy*this.dt,this.heroPosY+this.cy>this.heroPosY?(this.hero.y=this.heroPosY+this.cy,this.vy<=this.mvy&&(this.vy+=this.gravity)):this.heroJumping&&(this.heroLanded(),this.hero.y=this.heroPosY,this.vy=0),this.findCollision())}}),cc._RF.pop()},{}],music:[function(t,i,e){"use strict";cc._RF.push(i,"68a3cMvntFLpqdvhTqC8gn2","music"),cc.Class({extends:cc.Component,properties:{bgm:cc.AudioClip,gong:cc.AudioClip,jump:cc.AudioClip,throw:cc.AudioClip,wood:cc.AudioClip,bonus:cc.AudioClip,click:cc.AudioClip,gameOver:cc.AudioClip,coin:cc.AudioClip},onLoad:function(){this.isMusicPlaying=!1},playBgMusic:function(){this.isMusicPlaying?cc.audioEngine.resumeMusic():(cc.audioEngine.playMusic(this.bgm,!0),cc.audioEngine.setMusicVolume(.3)),this.isMusicPlaying=!0},stopBgMusic:function(){cc.audioEngine.pauseMusic()},playBonus:function(){cc.audioEngine.playEffect(this.bonus,!1)},playCoin:function(){cc.audioEngine.playEffect(this.coin,!1)},playGong:function(){cc.audioEngine.play(this.gong,!1,1)},playClick:function(){cc.audioEngine.playEffect(this.click,!1)},playJump:function(){cc.audioEngine.playEffect(this.jump,!1)},playKnifeThrow:function(){cc.audioEngine.playEffect(this.throw,!1)},playStickLanded:function(){cc.audioEngine.play(this.wood,!1,.2)},playGameOver:function(){cc.audioEngine.play(this.gameOver,!1,1)},playHit:function(){cc.audioEngine.playEffect(this.jump,!1)},playDead:function(){cc.audioEngine.play(this.jump,!1,1)},playFalling:function(){cc.audioEngine.play(this.jump,!1,1)}}),cc._RF.pop()},{}],treasure:[function(t,i,e){"use strict";cc._RF.push(i,"8200088y3VPqp9YPAv20f64","treasure"),cc.Class({extends:cc.Component,properties:{},ctor:function(){this.treasureValue=0,this.isHit=!1},onLoad:function(){},getRandomBetween:function(t,i){return Math.floor(Math.random()*(t-i+1)+i)},startTween:function(t){t/=1e3,this.moveTween=cc.tween(this.node).delay(t).then(cc.tween().by(1,{y:-10},{easing:"sineOut"}).by(1,{y:10},{easing:"sineOut"})).repeatForever().start()},stopTween:function(){this.moveTween.stop()}}),cc._RF.pop()},{}]},{},["gameOver","heroManager","hudManager","main","music","treasure"]);